<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>Y-CHECK · 회원가입</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-[#f7f9fc] text-slate-900 pb-24">

<!-- 공통 헤더 -->
<header class="bg-white border-b">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 h-14 flex items-center justify-between">
        <div class="flex items-center gap-3">
            <a href="main.html" class="flex items-center gap-3">
                <img src="../img/ycheck_logo.png" alt="Y-CHECK 로고" class="h-8 w-auto">
            </a>
            <div class="h-4 w-px bg-slate-200"></div>
            <div class="text-sm text-slate-600">연세대학교 졸업요건계산기</div>
        </div>
        <nav class="hidden sm:flex items-center gap-6 text-sm text-slate-600">
            <a href="calculator.html" class="hover:text-slate-900">계산기</a>
            <a href="timetable.html" class="hover:text-slate-900">시간표</a>
            <a href="sunbae.html" class="hover:text-slate-900">선배들의 발자취</a>
            <a href="mypage.html" class="hover:text-slate-900">마이페이지</a>
        </nav>
    </div>
</header>

<main class="max-w-7xl mx-auto px-4 sm:px-6 py-10 grid place-items-center">
    <section class="bg-white rounded-2xl border shadow-sm w-full max-w-xl p-8">
        <h1 class="text-2xl font-bold">회원가입</h1>
        <p class="text-slate-600 text-sm mt-1">기본 정보를 입력해 주세요.</p>

        <!-- 회원가입 폼 -->
        <form id="registerForm" class="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-4">
            <!-- ID -->
            <div class="sm:col-span-2">
                <label class="block text-sm text-slate-600 mb-1" for="username">ID</label>
                <input id="username" name="username" type="text" required
                       class="w-full rounded-xl border px-3 py-2" placeholder="아이디">
            </div>

            <!-- Password -->
            <div class="sm:col-span-2">
                <label class="block text-sm text-slate-600 mb-1" for="password">Password</label>
                <input id="password" name="password" type="password" required
                       class="w-full rounded-xl border px-3 py-2" placeholder="비밀번호">
            </div>

            <!-- 이름(실명) -->
            <div>
                <label class="block text-sm text-slate-600 mb-1" for="real_name">이름</label>
                <input id="real_name" name="real_name" type="text" required
                       class="w-full rounded-xl border px-3 py-2">
            </div>

            <!-- 학번 -->
            <div>
                <label class="block text-sm text-slate-600 mb-1" for="student_id">학번</label>
                <input id="student_id" name="student_id" type="text" required
                       class="w-full rounded-xl border px-3 py-2">
            </div>

            <!-- 학과/학부 (드롭다운) -->
            <div class="sm:col-span-2">
                <label class="block text-sm text-slate-600 mb-1" for="major_department">학과/학부</label>
                <select id="major_department" name="major_department" required
                        class="w-full rounded-xl border px-3 py-2 text-sm">
                    <option value="">선택하세요</option>
                    <option value="SOFTWARE">소프트웨어학부</option>
                    <option value="DATASCIENCE">데이터사이언스학부</option>
                    <option value="AI_SEMI">AI반도체학부</option>
                    <option value="BIOMED">의공학부</option>
                    <option value="CLINICAL">임상병리학과</option>
                    <option value="OCC_THERAPY">작업치료학과</option>
                </select>
            </div>

            <!-- 현재 학년/학기 -->
            <div class="sm:col-span-2">
                <label class="block text-sm text-slate-600 mb-1" for="current_semester">현재 학년/학기</label>
                <select id="current_semester" name="current_semester" required
                        class="w-full rounded-xl border px-3 py-2 text-sm">
                    <option value="">선택하세요</option>
                    <option value="1-1">1학년 1학기</option>
                    <option value="1-2">1학년 2학기</option>
                    <option value="2-1">2학년 1학기</option>
                    <option value="2-2">2학년 2학기</option>
                    <option value="3-1">3학년 1학기</option>
                    <option value="3-2">3학년 2학기</option>
                    <option value="4-1">4학년 1학기</option>
                    <option value="4-2">4학년 2학기</option>
                </select>
            </div>

            <!-- 관심 분야 -->
            <fieldset class="sm:col-span-2 border rounded-xl p-4">
                <legend class="px-1 text-sm text-slate-600">관심 전공/분야</legend>
                <div class="grid grid-cols-2 gap-2 text-sm mt-1">
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="interest" value="AI_ML" required>
                        <span>AI/머신러닝</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="interest" value="SECURITY_NETWORK">
                        <span>보안/네트워크</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="interest" value="GAME_MEDIA">
                        <span>게임/미디어</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="interest" value="EMBEDDED_SYSTEM">
                        <span>임베디드/시스템</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="interest" value="STARTUP_SERVICE">
                        <span>창업/서비스 기획</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="interest" value="OTHER">
                        <span>기타 (직접 입력)</span>
                    </label>
                </div>

                <!-- 기타 입력창 -->
                <label id="interestTextLabel" class="block mt-3 text-sm text-slate-600 hidden">
                    기타 관심 분야
                    <input type="text" name="interest_text"
                           class="mt-1 w-full rounded-xl border px-3 py-2 text-sm"
                           placeholder="예: HCI, 블록체인 등">
                </label>
            </fieldset>

            <!-- 데이터 사용 동의 -->
            <div class="sm:col-span-2 flex items-center gap-2 mt-2">
                <input id="dataConsent" name="data_consent" type="checkbox" class="h-4 w-4">
                <span class="text-sm text-slate-700">
                    위 정보가 졸업요건/추천 교과 계산에 사용되는 것에 동의합니다.
                </span>
            </div>

            <!-- 결과 메시지 -->
            <p id="result" class="sm:col-span-2 mt-2 text-sm font-semibold text-slate-700"></p>

            <!-- 버튼 -->
            <div class="sm:col-span-2 space-y-2 mt-2">
                <button type="submit"
                        class="w-full rounded-xl bg-blue-700 text-white py-2 text-sm font-semibold">
                    계정 생성하기
                </button>
                <a href="login.html"
                   class="w-full inline-flex justify-center rounded-xl border py-2 text-sm">
                    이미 계정이 있으신가요? 로그인
                </a>
            </div>
        </form>

        <div class="mt-6 text-xs text-slate-500">
            ※ 본 서비스는 비공식 참고용이며, 실제 인정은 학교 정책을 따릅니다.
        </div>
    </section>
</main>

<!-- 공통 푸터 -->
<footer class="fixed bottom-0 inset-x-0 bg-white border-t">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 py-4 flex items-start justify-between">
        <div class="flex items-start gap-4">
            <img src="../img/ycheck_logo.png" alt="Y-CHECK 로고" class="h-6 w-auto" />
            <div class="space-y-1 text-sm text-slate-600 leading-relaxed">
                <div>강원특별자치도 원주시 흥업면 연세대길 1 창조관</div>
                <div>TEL) 033-123-4567</div>
                <div>EMAIL: YCHECK@gmail.com</div>
            </div>
        </div>
        <div class="flex items-center gap-6 text-sm text-slate-600">
            <span class="hidden sm:block h-6 w-px bg-slate-200"></span>
            <span>만든이들</span>
            <span>문의하기</span>
        </div>
    </div>
</footer>

<!-- JS -->
<script>
    const form = document.getElementById('registerForm');
    const result = document.getElementById('result');
    const interestRadios = document.querySelectorAll('input[name="interest"]');
    const interestTextLabel = document.getElementById('interestTextLabel');
    const dataConsent = document.getElementById('dataConsent');

    // 기타 선택 시 입력창 표시
    interestRadios.forEach(radio => {
        radio.addEventListener('change', () => {
            if (radio.value === 'OTHER' && radio.checked) {
                interestTextLabel.classList.remove('hidden');
            } else if (radio.checked) {
                interestTextLabel.classList.add('hidden');
                interestTextLabel.querySelector('input[name="interest_text"]').value = '';
            }
        });
    });

    // 제출
    form.addEventListener('submit', async (e) => {
        e.preventDefault();

        if (!dataConsent.checked) {
            result.textContent = '데이터 사용에 동의해야 회원가입이 가능합니다.';
            return;
        }

        const formData = new FormData(form);

        try {
            const res = await fetch('/api/register/', {
                method: 'POST',
                body: formData,
            });

            const data = await res.json();
            result.textContent = data.message || '응답 받음';

            if (res.ok) {
                // 회원가입 성공 시 이동하려면 아래 주석 해제
                // location.href = 'login.html';
            }
        } catch (err) {
            console.error(err);
            result.textContent = '요청 중 오류가 발생했습니다.';
        }
    });
</script>

</body>
</html>

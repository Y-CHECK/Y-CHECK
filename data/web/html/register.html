<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>Y-CHECK · 회원가입</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-[#f7f9fc] text-slate-900">

<!-- 공통 헤더 -->
<header class="bg-white border-b">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 h-14 flex items-center justify-between">

        <!-- 1. 로고 (좌측) -->
        <div class="flex items-center gap-3">
            <a href="main" class="flex items-center gap-3">
                <img src="../img/ycheck_logo.png" alt="Y_CHECK 로고" class="h-8 w-auto">
            </a>
        </div>

        <!-- 2. 내비게이션 -->
        <nav class="hidden sm:flex items-center justify-center flex-1 divide-x divide-slate-300" style="margin-left: 90px;">
            <a href="calculator" class="px-6 py-2 text-sm text-slate-600 hover:text-slate-900 font-bold">계산기</a>
            <a href="timetable" class="px-6 py-2 text-sm text-slate-900 font-bold">시간표</a>
            <a href="sunbae" class="px-6 py-2 text-sm text-slate-600 hover:text-slate-900 font-bold">선배의 발자취</a>
        </nav>

        <!-- 3. 마이페이지 버튼 (우측) -->
        <div class="hidden sm:block">
            <a href="mypage" class="px-6 py-2 text-sm text-slate-600 hover:text-slate-900 font-bold">마이페이지</a>
        </div>
    </div>
</header>

<main class="max-w-7xl mx-auto px-4 sm:px-6 py-10 grid place-items-center">
    <section class="bg-white rounded-2xl border shadow-sm w-full max-w-xl p-8">
        <h1 class="text-2xl font-bold">회원가입</h1>
        <p class="text-slate-600 text-sm mt-1">기본 정보를 입력해 주세요.</p>

        <!-- 회원가입 폼 -->
        <form id="registerForm" class="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-4">
            <!-- ID -->
            <div class="sm:col-span-2">
                <label class="block text-sm text-slate-600 mb-1" for="username">ID</label>
                <input id="username" name="username" type="text" required
                       class="w-full rounded-xl border px-3 py-2" placeholder="아이디">
            </div>

            <!-- Password -->
            <div class="sm:col-span-2">
                <label class="block text-sm text-slate-600 mb-1" for="password">Password</label>
                <input id="password" name="password" type="password" required
                       class="w-full rounded-xl border px-3 py-2" placeholder="비밀번호">
            </div>

            <!-- 이름(실명) -->
            <div>
                <label class="block text-sm text-slate-600 mb-1" for="real_name">이름</label>
                <input id="real_name" name="real_name" type="text" required
                       class="w-full rounded-xl border px-3 py-2">
            </div>

            <!-- 학번 -->
            <div>
                <label class="block text-sm text-slate-600 mb-1" for="student_id">학번</label>
                <input id="student_id" name="student_id" type="text" required
                       class="w-full rounded-xl border px-3 py-2">
            </div>

            <!-- 학과/학부 (드롭다운) -->
            <div class="sm:col-span-2">
                <label class="block text-sm text-slate-600 mb-1" for="major_department">학과/학부</label>
                <select id="major_department" name="major_department" required
                        class="w-full rounded-xl border px-3 py-2 text-sm">
                    <option value="">선택하세요</option>
                    <option value="SOFTWARE">소프트웨어학부</option>
                    <option value="DATASCIENCE">데이터사이언스학부</option>
                    <option value="AI_SEMI">AI반도체학부</option>
                    <option value="BIOMED">의공학부</option>
                    <option value="CLINICAL">임상병리학과</option>
                    <option value="OCC_THERAPY">작업치료학과</option>
                </select>
            </div>

            <!-- 현재 학년/학기 -->
            <div class="sm:col-span-2">
                <label class="block text-sm text-slate-600 mb-1" for="current_semester">현재 학년/학기</label>
                <select id="current_semester" name="current_semester" required
                        class="w-full rounded-xl border px-3 py-2 text-sm">
                    <option value="">선택하세요</option>
                    <option value="1-1">1학년 1학기</option>
                    <option value="1-2">1학년 2학기</option>
                    <option value="2-1">2학년 1학기</option>
                    <option value="2-2">2학년 2학기</option>
                    <option value="3-1">3학년 1학기</option>
                    <option value="3-2">3학년 2학기</option>
                    <option value="4-1">4학년 1학기</option>
                    <option value="4-2">4학년 2학기</option>
                </select>
            </div>

            <!-- 관심 분야 -->
            <fieldset class="sm:col-span-2 border rounded-xl p-4">
                <legend class="px-1 text-sm text-slate-600">관심 전공/분야</legend>
                <div class="grid grid-cols-2 gap-2 text-sm mt-1">
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="interest" value="AI_ML" required>
                        <span>AI/머신러닝</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="interest" value="SECURITY_NETWORK">
                        <span>보안/네트워크</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="interest" value="GAME_MEDIA">
                        <span>게임/미디어</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="interest" value="EMBEDDED_SYSTEM">
                        <span>임베디드/시스템</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="interest" value="STARTUP_SERVICE">
                        <span>창업/서비스 기획</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="interest" value="OTHER">
                        <span>기타 (직접 입력)</span>
                    </label>
                </div>

                <!-- 기타 입력창 -->
                <label id="interestTextLabel" class="block mt-3 text-sm text-slate-600 hidden">
                    기타 관심 분야
                    <input type="text" name="interest_text"
                           class="mt-1 w-full rounded-xl border px-3 py-2 text-sm"
                           placeholder="예: HCI, 블록체인 등">
                </label>
            </fieldset>

            <!-- 데이터 사용 동의 -->
            <div class="sm:col-span-2 flex items-center gap-2 mt-2">
                <input id="dataConsent" name="data_consent" type="checkbox" class="h-4 w-4">
                <span class="text-sm text-slate-700">
                    위 정보가 졸업요건/추천 교과 계산에 사용되는 것에 동의합니다.
                </span>
            </div>

            <!-- 결과 메시지 -->
            <p id="result" class="sm:col-span-2 mt-2 text-sm font-semibold text-slate-700"></p>

            <!-- 버튼 -->
            <div class="sm:col-span-2 space-y-2 mt-2">
                <button type="submit"
                        class="w-full rounded-xl bg-blue-700 text-white py-2 text-sm font-semibold">
                    계정 생성하기
                </button>
                <a href="login"
                   class="w-full inline-flex justify-center rounded-xl border py-2 text-sm">
                    이미 계정이 있으신가요? 로그인
                </a>
            </div>
        </form>

        <div class="mt-6 text-xs text-slate-500">
            ※ 본 서비스는 비공식 참고용이며, 실제 인정은 학교 정책을 따릅니다.
        </div>
    </section>
</main>

<!-- ==== 공통 푸터 + 모달 + 스크립트 ==== -->
<footer class="bg-white border-t w-full">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 py-4 flex items-start justify-between">
        <div class="flex items-start gap-4">
            <div class="space-y-0.5 text-sm text-slate-600 leading-tight">
                <div>Inc: 강원특별자치도 원주시 흥업면 연세대길 1</div>
                <div>Instagram: @Y_CHECK.YONSEI</div>
                <div>Email: YCHECK2025@gmail.com</div>
            </div>
        </div>
        <div class="flex items-center gap-6 text-sm text-slate-600 leading-tight" style="margin-top: 12px;">
            <span class="hidden sm:block h-6 w-px bg-slate-200"></span>
            <a href="#" class="text-xs text-blak-600 hover:underline" id="open-makers-modal"><span>만든이들</span></a>
            <a href="#" class="text-xs text-black-600 hover:underline" id="open-contact-modal"><span>문의하기</span></a>
        </div>
    </div>
</footer>

<!-- 만든이들 모달 -->
<div id="makers-modal-overlay"
     class="fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center z-50 hidden">
    <div class="bg-white rounded-2xl px-6 py-8 w-full max-w-md shadow-xl relative">
        <button id="close-makers-modal"
                class="absolute top-3 right-3 text-slate-500 hover:text-slate-700 text-2xl font-bold"
                aria-label="닫기">
            &times;
        </button>
        <h2 class="text-xl font-bold mb-4 text-center">만든이들</h2>
        <div class="space-y-2 text-sm text-slate-700">
            <div><strong>PM</strong> – CHOI</div>
            <div><strong>Back-end</strong> – KIM / MA</div>
            <div><strong>Front-end</strong> – YU / LEE</div>
            <hr class="my-2">
            <div class="text-xs text-slate-500">
                Y_CHECK 서비스는 위 팀원이 함께 만들었습니다.<br>
                궁금한 점은 언제든 문의해 주세요!
            </div>
        </div>
    </div>
</div>



<!-- 문의하기 모달 -->
<div id="contact-modal-overlay"
     class="fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center z-50 hidden">
    <div class="bg-white rounded-2xl px-6 py-8 w-full max-w-md shadow-xl relative">
        <button id="close-contact-modal"
                class="absolute top-3 right-3 text-slate-500 hover:text-slate-700 text-2xl font-bold"
                aria-label="닫기">&times;</button>
        <h2 class="text-xl font-bold mb-5 text-center">문의하기</h2>
        <form class="space-y-4" id="contact-form" autocomplete="off">
            <div>
                <label for="inquiry-type" class="block text-sm mb-1 font-medium text-slate-700">문의 유형</label>
                <select id="inquiry-type" name="inquiry-type" class="w-full rounded-xl border px-3 py-2 text-sm">
                    <option value="" selected disabled>문의 유형을 선택하세요</option>
                    <option value="계정">계정 관련</option>
                    <option value="불편">이용 불편</option>
                    <option value="건의">기능 건의</option>
                    <option value="오류">버그/오류 신고</option>
                    <option value="기타">기타(직접입력)</option>
                </select>
            </div>
            <div id="custom-type-wrap" class="hidden">
                <input type="text" id="custom-type"
                       class="w-full rounded-xl border px-3 py-2 text-sm mt-2"
                       placeholder="문의 종류를 입력하세요">
            </div>
            <div>
                <label for="inquiry-content" class="block text-sm mb-1 font-medium text-slate-700">문의 내용</label>
                <textarea id="inquiry-content" name="inquiry-content"
                          rows="4"
                          class="w-full rounded-xl border px-3 py-2 text-sm resize-none"
                          placeholder="문의하실 내용을 입력해 주세요."
                          required></textarea>
            </div>
            <button type="submit"
                    class="w-full rounded-xl bg-blue-700 text-white py-2 text-sm font-semibold mt-2">
                문의 접수하기
            </button>
        </form>
        <div id="contact-success" class="hidden mt-4 text-green-600 text-sm text-center font-semibold">
            문의가 정상적으로 접수되었습니다.
        </div>
    </div>
</div>

<!-- JS -->
<script>
    const form = document.getElementById('registerForm');
    const result = document.getElementById('result');
    const interestRadios = document.querySelectorAll('input[name="interest"]');
    const interestTextLabel = document.getElementById('interestTextLabel');
    const dataConsent = document.getElementById('dataConsent');

    // 기타 선택 시 입력창 표시
    interestRadios.forEach(radio => {
        radio.addEventListener('change', () => {
            if (radio.value === 'OTHER' && radio.checked) {
                interestTextLabel.classList.remove('hidden');
            } else if (radio.checked) {
                interestTextLabel.classList.add('hidden');
                interestTextLabel.querySelector('input[name="interest_text"]').value = '';
            }
        });
    });

    // 제출
    form.addEventListener('submit', async (e) => {
        e.preventDefault();

        if (!dataConsent.checked) {
            result.textContent = '데이터 사용에 동의해야 회원가입이 가능합니다.';
            return;
        }

        const formData = new FormData(form);

        try {
            const res = await fetch('/api/register/', {
                method: 'POST',
                body: formData,
            });

            const data = await res.json();
            result.textContent = data.message || '응답 받음';

            if (res.ok) {
                // 회원가입 성공 시 이동하려면 아래 주석 해제
                location.href = 'login';
            }
        } catch (err) {
            console.error(err);
            result.textContent = '요청 중 오류가 발생했습니다.';
        }
    });
</script>

</body>
</html>

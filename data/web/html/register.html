<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>회원가입</title>
    <style>
        body { max-width: 480px; margin: 30px auto; font-family: sans-serif; }
        label { display: block; margin-top: 12px; font-weight: 600; }
        .interest-group { margin-top: 8px; }
        .interest-group label { font-weight: normal; display: block; margin-bottom: 4px; }
        .hidden { display: none; }
    </style>
</head>
<body>
<h1>회원가입</h1>

<form id="registerForm">
    <!-- 기본 계정 정보 -->
    <label>
        아이디
        <input type="text" name="username" required>
    </label>

    <label>
        비밀번호
        <input type="password" name="password" required>
    </label>

    <label>
        이메일
        <input type="email" name="email" required>
    </label>

    <!-- 추가 정보 -->
    <label>
        학번
        <input type="text" name="student_id" required>
    </label>

    <label>
        이름(실명)
        <input type="text" name="real_name" required>
    </label>

    <label>
        현재 학년/학기
        <select name="current_semester" required>
            <option value="">선택하세요</option>
            <option value="1-1">1학년 1학기</option>
            <option value="1-2">1학년 2학기</option>
            <option value="2-1">2학년 1학기</option>
            <option value="2-2">2학년 2학기</option>
            <option value="3-1">3학년 1학기</option>
            <option value="3-2">3학년 2학기</option>
            <option value="4-1">4학년 1학기</option>
            <option value="4-2">4학년 2학기</option>
        </select>
    </label>

    <!-- 관심 전공/분야 -->
    <label>관심 전공/분야</label>
    <div class="interest-group">
        <label><input type="radio" name="interest" value="AI_ML" required> AI / 머신러닝</label>
        <label><input type="radio" name="interest" value="SECURITY_NETWORK"> 보안 / 네트워크</label>
        <label><input type="radio" name="interest" value="GAME_MEDIA"> 게임 / 미디어</label>
        <label><input type="radio" name="interest" value="EMBEDDED_SYSTEM"> 임베디드 / 시스템</label>
        <label><input type="radio" name="interest" value="STARTUP_SERVICE"> 창업 / 서비스 기획</label>
        <label><input type="radio" name="interest" value="OTHER"> 기타 (직접 입력)</label>
    </div>

    <label id="interestTextLabel" class="hidden">
        기타 관심 분야
        <input type="text" name="interest_text" placeholder="예: HCI, 블록체인 등">
    </label>

    <!-- 데이터 사용 동의 -->
    <label style="margin-top:14px;">
        <input type="checkbox" name="data_consent" id="dataConsent">
        위 정보가 졸업요건/추천 교과 계산에 사용되는 것에 동의합니다.
    </label>

    <button type="submit" style="margin-top:16px;">회원가입</button>
</form>

<p id="result" style="margin-top: 16px; font-weight: 600;"></p>

<script>
    const form = document.getElementById('registerForm');
    const result = document.getElementById('result');
    const interestRadios = document.querySelectorAll('input[name="interest"]');
    const interestTextLabel = document.getElementById('interestTextLabel');
    const dataConsent = document.getElementById('dataConsent');

    // 기타 선택 시만 입력창 보이기
    interestRadios.forEach(radio => {
        radio.addEventListener('change', () => {
            if (radio.value === 'OTHER' && radio.checked) {
                interestTextLabel.classList.remove('hidden');
            } else if (radio.checked) {
                interestTextLabel.classList.add('hidden');
                // 기타 아니면 값 비우기
                interestTextLabel.querySelector('input[name="interest_text"]').value = '';
            }
        });
    });

    form.addEventListener('submit', async (e) => {
        e.preventDefault();

        if (!dataConsent.checked) {
            result.textContent = '데이터 사용에 동의해야 회원가입이 가능합니다.';
            return;
        }

        const formData = new FormData(form);

        try {
            const res = await fetch('/api/register/', {
                method: 'POST',
                body: formData,
            });

            const data = await res.json();
            result.textContent = data.message || '응답 받음';

            if (res.ok) {
                // 예: 회원가입 성공 후 이동
                // location.href = '/login.html';
            }
        } catch (err) {
            console.error(err);
            result.textContent = '요청 중 오류가 발생했습니다.';
        }
    });
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>Y-CHECK · 선배들의 발자취</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-[#f7f9fc] text-slate-900 flex flex-col">

<!-- 공통 헤더 -->
<header class="bg-white border-b">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 h-14 flex items-center justify-between">
        <!-- 로고 -->
        <div class="flex items-center gap-3">
            <a href="main" class="flex items-center gap-3">
                <img src="../img/ycheck_logo.png" alt="Y-CHECK 로고" class="h-8 w-auto">
            </a>
        </div>

        <!-- 네비게이션 -->
        <nav class="hidden sm:flex items-center justify-center flex-1 divide-x divide-slate-300" style="margin-left: 90px;">
            <a href="calculator" class="px-6 py-2 text-sm text-slate-600 hover:text-slate-900 font-bold">계산기</a>
            <a href="timetable" class="px-6 py-2 text-sm text-slate-600 hover:text-slate-900 font-bold">시간표</a>
            <a href="sunbae" class="px-6 py-2 text-sm text-blue-700 hover:text-blue-800 font-bold">선배들의 발자취</a>
        </nav>

        <!-- 마이페이지 -->
        <div class="hidden sm:block">
            <a href="mypage" class="px-6 py-2 text-sm text-slate-600 hover:text-slate-900 font-bold">마이페이지</a>
        </div>
    </div>
</header>


<main class="max-w-7xl mx-auto px-4 sm:px-6 py-8 flex-1">
    <!-- 왼쪽(필터) / 오른쪽(이수 기록) 레이아웃 -->
    <section class="grid grid-cols-1 lg:grid-cols-[0.9fr_2.1fr] gap-6">
        <!-- 왼쪽 박스: 선배 선택 / 필터 -->
        <div class="bg-white rounded-2xl border shadow-sm p-6 min-h-[620px] flex flex-col">
            <h2 class="text-xl font-semibold mb-4">선배 선택/필터</h2>

            <!-- 관심 트랙 선택 -->
            <div class="mb-5">
                <div class="text-sm text-slate-600 mb-2">관심 트랙 선택</div>
                <div class="flex flex-col gap-2 text-sm">
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="track" value="AI" class="h-4 w-4" id="track-ai-radio">
                        <span>AI/머신러닝</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="track" value="SECURITY" class="h-4 w-4" id="track-sec-radio">
                        <span>보안/네트워크</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="track" value="GAME" class="h-4 w-4" id="track-game-radio">
                        <span>게임/미디어</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="track" value="EMBEDDED" class="h-4 w-4" id="track-embedded-radio">
                        <span>임베디드/시스템</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="track" value="STARTUP" class="h-4 w-4" id="track-startup-radio">
                        <span>창업/서비스 기획</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <input type="radio" name="track" value="OTHER" id="track-other-radio" class="h-4 w-4">
                        <span>기타 (직접 입력)</span>
                    </label>
                </div>

                <!-- 기타 트랙 직접 입력 -->
                <div id="track-other-wrap" class="mt-3 hidden">
                    <label class="block text-xs text-slate-500 mb-1">기타 관심 트랙</label>
                    <input
                            type="text"
                            id="track-other-input"
                            class="w-full rounded-xl border px-3 py-2 text-sm"
                            placeholder="예: HCI, 블록체인 등"
                    >
                </div>
            </div>

            <!-- 선배 학년 + 전공 과목 유형 필터 -->
            <div class="space-y-4 flex-1">
                <div>
                    <div class="text-sm text-slate-600 mb-1">선배 학년</div>
                    <select id="gradeSelect" class="w-full rounded-xl border px-3 py-2 text-sm">
                        <option value="">전체</option>
                        <option value="2">2학년</option>
                        <option value="3">3학년</option>
                        <option value="4">4학년</option>
                    </select>
                </div>

                <div>
                    <div class="text-sm text-slate-600 mb-1">전공 과목 유형 필터</div>
                    <div class="flex flex-col gap-2 text-sm">
                        <label class="inline-flex items-center gap-2">
                            <input type="checkbox" id="filter-major-all" class="h-4 w-4">
                            <span>전체 보기</span>
                        </label>
                        <label class="inline-flex items-center gap-2">
                            <input type="checkbox" id="filter-major-required" class="h-4 w-4">
                            <span>전공필수만 보기</span>
                        </label>
                        <label class="inline-flex items-center gap-2">
                            <input type="checkbox" id="filter-major-elective" class="h-4 w-4">
                            <span>전공선택만 보기</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- 오른쪽 박스: 선배의 실제 이수 기록 -->
        <div class="bg-white rounded-2xl border shadow-sm p-6 min-h-[620px] flex flex-col">
            <div class="flex items-center justify-between mb-2">
                <h3 class="text-lg font-semibold">선배의 실제 이수 기록</h3>
                <p id="sunbaeSummaryText" class="text-xs text-slate-500">
                    공유된 시간표를 불러오는 중입니다...
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 flex-1">
                <!-- 선배 목록 -->
                <div class="lg:col-span-1 flex flex-col">
                    <div class="text-sm text-slate-600 mb-2">선배 목록</div>
                    <div class="space-y-3 max-h-[420px] overflow-y-auto pr-1" id="senior-list">
                        <!-- JS에서 버튼 생성 -->
                    </div>
                    <div id="sunbae-empty-state" class="text-xs text-slate-500 mt-4 hidden">
                        조건에 맞는 선배 시간표가 없습니다.
                    </div>
                </div>

                <!-- 상세 이수 기록 영역 -->
                <div class="lg:col-span-2 bg-slate-50 rounded-xl p-4 flex flex-col h-full" id="senior-detail">
                    <div class="flex items-center justify-between gap-3">
                        <div>
                            <div id="detail-name" class="text-base font-semibold">공유된 시간표</div>
                            <div id="detail-meta" class="text-xs text-slate-600 mt-0.5">
                                선배의 실제 이수 기록을 선택해 주세요.
                            </div>
                        </div>
                    </div>

                    <!-- 요약 텍스트 -->
                    <div id="detail-summary" class="text-xs text-slate-600 mt-2">
                        조건에 맞는 시간표를 선택하면 과목 목록이 표시됩니다.
                    </div>

                    <!-- 이수 과목 리스트 -->
                    <div id="records-scroll" class="mt-3 flex-1 overflow-y-auto space-y-4 pr-2">
                        <!-- 항상 보이는 요약 영역 -->
                        <div>
                            <div class="text-sm font-semibold mb-2 text-slate-700">이수 과목</div>
                            <div id="summary-body" class="space-y-3 text-sm">
                                <!-- 선택된 시간표의 과목을 JS로 렌더링 -->
                            </div>
                        </div>

                        <!-- 추가 영역 (확장용) -->
                        <div>
                            <div id="detail-body" class="space-y-3 text-sm hidden"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<!-- 푸터 -->
<footer class="bg-white border-t w-full">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 py-4 flex items-start justify-between">
        <div class="flex items-start gap-4">
            <div class="space-y-0.5 text-sm text-slate-600 leading-tight">
                <div>Inc: 강원특별자치도 원주시 흥업면 연세대길 1</div>
                <div>Instagram: @Y_CHECK.YONSEI</div>
                <div>Email: YCHECK2025@gmail.com</div>
            </div>
        </div>
        <div class="flex items-center gap-6 text-sm text-slate-600 leading-tight" style="margin-top: 12px;">
            <span class="hidden sm:block h-6 w-px bg-slate-200"></span>
            <a href="#" class="text-xs text-black-600 hover:underline" id="open-makers-modal"><span>만든이들</span></a>
            <a href="#" class="text-xs text-black-600 hover:underline" id="open-contact-modal"><span>문의하기</span></a>
        </div>
    </div>
</footer>

<!-- 만든이들 모달 -->
<div id="makers-modal-overlay"
     class="fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center z-50 hidden">
    <div class="bg-white rounded-2xl px-6 py-8 w-full max-w-md shadow-xl relative">
        <button id="close-makers-modal"
                class="absolute top-3 right-3 text-slate-500 hover:text-slate-700 text-2xl font-bold"
                aria-label="닫기">
            &times;
        </button>
        <h2 class="text-xl font-bold mb-4 text-center">만든이들</h2>
        <div class="space-y-2 text-sm text-slate-700">
            <div><strong>PM</strong> – CHOI</div>
            <div><strong>Back-end</strong> – KIM / MA</div>
            <div><strong>Front-end</strong> – YU / LEE</div>
            <hr class="my-2">
            <div class="text-xs text-slate-500">
                Y_CHECK 서비스는 위 팀원이 함께 만들었습니다.<br>
                궁금한 점은 언제든 문의해 주세요!
            </div>
        </div>
    </div>
</div>

<!-- 문의하기 모달 -->
<div id="contact-modal-overlay"
     class="fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center z-50 hidden">
    <div class="bg-white rounded-2xl px-6 py-8 w-full max-w-md shadow-xl relative">
        <button id="close-contact-modal"
                class="absolute top-3 right-3 text-slate-500 hover:text-slate-700 text-2xl font-bold"
                aria-label="닫기">&times;</button>
        <h2 class="text-xl font-bold mb-5 text-center">문의하기</h2>
        <form class="space-y-4" id="contact-form" autocomplete="off">
            <div>
                <label for="inquiry-type" class="block text-sm mb-1 font-medium text-slate-700">문의 유형</label>
                <select id="inquiry-type" name="inquiry-type" class="w-full rounded-xl border px-3 py-2 text-sm">
                    <option value="" selected disabled>문의 유형을 선택하세요</option>
                    <option value="계정">계정 관련</option>
                    <option value="불편">이용 불편</option>
                    <option value="건의">기능 건의</option>
                    <option value="오류">버그/오류 신고</option>
                    <option value="기타">기타(직접입력)</option>
                </select>
            </div>
            <div id="custom-type-wrap" class="hidden">
                <input type="text" id="custom-type"
                       class="w-full rounded-xl border px-3 py-2 text-sm mt-2"
                       placeholder="문의 종류를 입력하세요">
            </div>
            <div>
                <label for="inquiry-content" class="block text-sm mb-1 font-medium text-slate-700">문의 내용</label>
                <textarea id="inquiry-content" name="inquiry-content"
                          rows="4"
                          class="w-full rounded-xl border px-3 py-2 text-sm resize-none"
                          placeholder="문의하실 내용을 입력해 주세요."
                          required></textarea>
            </div>
            <button type="submit"
                    class="w-full rounded-xl bg-blue-700 text-white py-2 text-sm font-semibold mt-2">
                문의 접수하기
            </button>
        </form>
        <div id="contact-success" class="hidden mt-4 text-green-600 text-sm text-center font-semibold">
            문의가 정상적으로 접수되었습니다.
        </div>
    </div>
</div>

<script>
    /* ====== 공통 모달 스크립트 ====== */
    const openMakersBtn = document.getElementById('open-makers-modal');
    const makersModal = document.getElementById('makers-modal-overlay');
    const closeMakersBtn = document.getElementById('close-makers-modal');
    if (openMakersBtn && makersModal && closeMakersBtn) {
        openMakersBtn.addEventListener('click', function(e) {
            e.preventDefault();
            makersModal.classList.remove('hidden');
        });
        closeMakersBtn.addEventListener('click', function() {
            makersModal.classList.add('hidden');
        });
        makersModal.addEventListener('click', function(e) {
            if (e.target === makersModal) {
                makersModal.classList.add('hidden');
            }
        });
        document.addEventListener('keydown', function(e) {
            if (!makersModal.classList.contains('hidden') && e.key === 'Escape') {
                makersModal.classList.add('hidden');
            }
        });
    }

    const openContactBtn = document.getElementById('open-contact-modal');
    const contactModal = document.getElementById('contact-modal-overlay');
    const closeContactBtn = document.getElementById('close-contact-modal');
    if (openContactBtn && contactModal && closeContactBtn) {
        openContactBtn.addEventListener('click', function(e) {
            e.preventDefault();
            contactModal.classList.remove('hidden');
        });
        closeContactBtn.addEventListener('click', function() {
            contactModal.classList.add('hidden');
        });
        contactModal.addEventListener('click', function(e) {
            if (e.target === contactModal) {
                contactModal.classList.add('hidden');
            }
        });

        const inquiryType = document.getElementById('inquiry-type');
        const customTypeWrap = document.getElementById('custom-type-wrap');
        const customTypeInput = document.getElementById('custom-type');
        if (inquiryType && customTypeWrap && customTypeInput) {
            inquiryType.addEventListener('change', function () {
                if (this.value === '기타') {
                    customTypeWrap.classList.remove('hidden');
                    customTypeInput.setAttribute('required', 'required');
                } else {
                    customTypeWrap.classList.add('hidden');
                    customTypeInput.value = '';
                    customTypeInput.removeAttribute('required');
                }
            });
        }

        const contactForm = document.getElementById('contact-form');
        const contactSuccess = document.getElementById('contact-success');
        if (contactForm && contactSuccess) {
            contactForm.addEventListener('submit', function(e) {
                e.preventDefault();
                contactForm.classList.add('hidden');
                contactSuccess.classList.remove('hidden');
                setTimeout(() => {
                    contactModal.classList.add('hidden');
                    contactForm.reset();
                    contactForm.classList.remove('hidden');
                    customTypeWrap.classList.add('hidden');
                    contactSuccess.classList.add('hidden');
                }, 1800);
            });
        }
    }

    /* ====== 관심 트랙 기타 입력 ====== */
    const trackRadios = document.querySelectorAll('input[name="track"]');
    const trackOtherWrap = document.getElementById('track-other-wrap');
    const trackOtherInput = document.getElementById('track-other-input');

    /* ====== 백엔드 연동용 공통 상태/요소 ====== */
    const summaryText = document.getElementById("sunbaeSummaryText");
    const emptyState = document.getElementById("sunbae-empty-state");
    const seniorList = document.getElementById("senior-list");

    const detailName = document.getElementById("detail-name");
    const detailMeta = document.getElementById("detail-meta");
    const detailSummary = document.getElementById("detail-summary");
    const summaryBody = document.getElementById("summary-body");
    const detailBody = document.getElementById("detail-body");
    const toggleDetailBtn = document.getElementById("toggle-detail"); // 없으면 그냥 null

    const gradeSelectEl = document.getElementById("gradeSelect");

    // 전공 필터 체크박스
    const majorAllEl = document.getElementById("filter-major-all");
    const majorRequiredEl = document.getElementById("filter-major-required");
    const majorElectiveEl = document.getElementById("filter-major-elective");

    let allRecords = [];   // 백엔드에서 받아온 전체 시간표 리스트
    let currentTrack = ""; // ""면 전체
    let currentGrade = ""; // ""면 전체
    let selectedIndex = -1;

    // 과목 유형 뱃지 색상 (전필/전선/기타)
    function getCategoryBadge(category) {
        if (category === "전필") return "bg-rose-100 text-rose-700";
        if (category === "전선") return "bg-emerald-100 text-emerald-700";
        return "bg-slate-100 text-slate-600";
    }

    // 선배 목록 렌더링
    function renderSeniorList() {
        seniorList.innerHTML = "";
        emptyState.classList.add("hidden");

        if (!allRecords.length) {
            emptyState.classList.remove("hidden");
            detailName.textContent = "공유된 시간표";
            detailMeta.textContent = "조건에 맞는 선배 시간표가 없습니다.";
            detailSummary.textContent = "";
            summaryBody.innerHTML = "";
            selectedIndex = -1;
            return;
        }

        allRecords.forEach((entry, idx) => {
            const btn = document.createElement("button");
            btn.type = "button";
            btn.className =
                "w-full text-left border rounded-xl px-3 py-2 text-sm hover:border-blue-500 hover:bg-blue-50";
            btn.dataset.index = idx.toString();
            btn.innerHTML = `
          <div class="font-semibold text-slate-800">${entry.label || "공유 시간표"}</div>
          <div class="text-xs text-slate-500">
            ${(entry.user && (entry.user.display_name || entry.user.username)) || "선배"}
          </div>
        `;
            btn.addEventListener("click", () => {
                setActiveSenior(idx);
                renderSelectedRecord(idx);
            });
            seniorList.appendChild(btn);
        });

        // 첫 번째 항목 자동 선택
        setActiveSenior(0);
        renderSelectedRecord(0);
    }

    // 선택된 선배 버튼 스타일 처리
    function setActiveSenior(index) {
        selectedIndex = index;
        const buttons = seniorList.querySelectorAll("button[data-index]");
        buttons.forEach((b, i) => {
            b.classList.remove(
                "border-blue-500",
                "ring-2",
                "ring-blue-400",
                "bg-blue-50"
            );
            if (i === index) {
                b.classList.add(
                    "border-blue-500",
                    "ring-2",
                    "ring-blue-400",
                    "bg-blue-50"
                );
            }
        });

        // 상세 영역 접기 초기화
        if (detailBody) {
            detailBody.classList.add("hidden");
        }
        if (toggleDetailBtn) {
            toggleDetailBtn.textContent = "자세한 이수 기록 보기";
        }
    }

    // 선택된 시간표 상세 렌더링
    function renderSelectedRecord(index) {
        const entry = allRecords[index];
        if (!entry) return;

        const userName =
            (entry.user && (entry.user.display_name || entry.user.username)) ||
            "선배";

        detailName.textContent = entry.label || "공유된 시간표";
        detailMeta.textContent = `${userName}의 공유 시간표`;

        const courses = Array.isArray(entry.courses) ? entry.courses : [];
        if (!courses.length) {
            detailSummary.textContent = "등록된 과목이 없습니다.";
            summaryBody.innerHTML = `<p class="text-xs text-slate-400">등록된 과목이 없습니다.</p>`;
            return;
        }

        detailSummary.textContent = `총 ${courses.length}개 과목이 등록되어 있습니다.`;

        summaryBody.innerHTML = "";
        const card = document.createElement("article");
        card.className = "border rounded-2xl p-4 bg-white shadow-sm text-sm";
        card.innerHTML = `
        <ul class="space-y-1">
          ${courses
            .map(
                (c) => `
            <li class="flex items-center justify-between">
              <span>${c.subject || "-"}</span>
              ${
                    c.memo
                        ? `<span class="px-2 py-0.5 rounded-full ${getCategoryBadge(
                            c.memo
                        )} text-xs">${c.memo}</span>`
                        : ""
                }
            </li>
          `
            )
            .join("")}
        </ul>
      `;
        summaryBody.appendChild(card);
    }

    // 공유된 시간표 불러오기 (백엔드 호출)
    async function loadSharedTimetables() {
        if (summaryText) {
            summaryText.textContent = "공유된 시간표를 불러오는 중입니다...";
        }
        allRecords = [];
        seniorList.innerHTML = "";
        emptyState.classList.add("hidden");
        summaryBody.innerHTML = "";
        detailName.textContent = "공유된 시간표";
        detailMeta.textContent = "선배의 실제 이수 기록을 선택해 주세요.";
        detailSummary.textContent = "조건에 맞는 시간표를 선택하면 과목 목록이 표시됩니다.";

        const params = new URLSearchParams();
        if (currentTrack) params.append("track", currentTrack);
        if (currentGrade) params.append("grade", currentGrade);

        // 전공 필터 체크박스 → 쿼리 파라미터
        const allChecked = majorAllEl && majorAllEl.checked;
        const reqChecked = majorRequiredEl && majorRequiredEl.checked;
        const elecChecked = majorElectiveEl && majorElectiveEl.checked;

        if (!allChecked) {
            // 전체 보기 체크 안 한 경우에만 세부 필터 적용
            if (reqChecked && !elecChecked) {
                params.append("major_required_only", "true");
            } else if (elecChecked && !reqChecked) {
                params.append("major_elective_only", "true");
            } else if (reqChecked && elecChecked) {
                // 둘 다 체크 → 백엔드에서 전체처럼 동작 (둘 다 true면 필터 안 거는 로직)
                params.append("major_required_only", "true");
                params.append("major_elective_only", "true");
            }
        }
        // allChecked === true 이면 major_* 파라미터 안 보냄 → 전체 보기

        const query = params.toString();
        const url = query
            ? `/api/footprints/timetables/?${query}`
            : `/api/footprints/timetables/`;

        try {
            const res = await fetch(url, {
                method: "GET",
                credentials: "include",
            });

            if (!res.ok) {
                if (summaryText) {
                    summaryText.textContent = "시간표를 불러오는 중 오류가 발생했습니다.";
                }
                emptyState.classList.remove("hidden");
                return;
            }

            const data = await res.json();
            const results = Array.isArray(data.results) ? data.results : [];

            allRecords = results;

            if (!allRecords.length) {
                if (summaryText) {
                    summaryText.textContent = "조건에 맞는 선배 시간표가 없습니다.";
                }
                emptyState.classList.remove("hidden");
                return;
            }

            renderSeniorList();

            if (summaryText) {
                summaryText.textContent = `조건에 맞는 선배 시간표 ${allRecords.length}개가 있습니다.`;
            }
        } catch (err) {
            console.error(err);
            if (summaryText) {
                summaryText.textContent = "시간표를 불러오는 중 오류가 발생했습니다.";
            }
            emptyState.classList.remove("hidden");
        }
    }

    // 트랙 라디오 + 기타 입력 + 백엔드 필터 연동
    if (trackRadios && trackOtherWrap && trackOtherInput) {
        trackRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                if (radio.value === 'OTHER' && radio.checked) {
                    trackOtherWrap.classList.remove('hidden');
                } else if (radio.checked) {
                    trackOtherWrap.classList.add('hidden');
                    trackOtherInput.value = '';
                }

                if (radio.checked) {
                    currentTrack = radio.value;
                    loadSharedTimetables();
                }
            });
        });
    }

    // 학년 선택 시 필터 연동
    if (gradeSelectEl) {
        gradeSelectEl.addEventListener("change", (e) => {
            currentGrade = e.target.value;
            loadSharedTimetables();
        });
    }

    // 전공 필터 체크박스 이벤트
    if (majorAllEl) {
        majorAllEl.addEventListener("change", () => {
            if (majorAllEl.checked) {
                if (majorRequiredEl) majorRequiredEl.checked = false;
                if (majorElectiveEl) majorElectiveEl.checked = false;
            }
            loadSharedTimetables();
        });
    }

    if (majorRequiredEl) {
        majorRequiredEl.addEventListener("change", () => {
            if (majorRequiredEl.checked && majorAllEl) {
                majorAllEl.checked = false;
            }
            loadSharedTimetables();
        });
    }

    if (majorElectiveEl) {
        majorElectiveEl.addEventListener("change", () => {
            if (majorElectiveEl.checked && majorAllEl) {
                majorAllEl.checked = false;
            }
            loadSharedTimetables();
        });
    }

    // 상세 토글 버튼 (있으면 동작, 없으면 무시)
    if (toggleDetailBtn && detailBody) {
        toggleDetailBtn.addEventListener("click", () => {
            const isHidden = detailBody.classList.contains("hidden");
            if (isHidden) {
                detailBody.classList.remove("hidden");
                toggleDetailBtn.textContent = "자세한 이수 기록 숨기기";
            } else {
                detailBody.classList.add("hidden");
                toggleDetailBtn.textContent = "자세한 이수 기록 보기";
            }
        });
    }

    // 초기 상태 설정
    (function initFiltersAndLoad() {
        // 기본 트랙: 아무 것도 선택 안 되어 있으면 AI로
        let defaultTrackRadio = document.querySelector('input[name="track"]:checked');
        if (!defaultTrackRadio) {
            const aiRadio = document.getElementById("track-ai-radio");
            if (aiRadio) {
                aiRadio.checked = true;
                defaultTrackRadio = aiRadio;
            }
        }
        currentTrack = defaultTrackRadio ? defaultTrackRadio.value : "";
        currentGrade = gradeSelectEl ? gradeSelectEl.value : "";

        // 기본: 전체 보기 체크
        if (majorAllEl) {
            majorAllEl.checked = true;
        }

        loadSharedTimetables();
    })();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>Y-CHECK Â· ì„ ë°°ë“¤ì˜ ë°œìì·¨</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-[#f7f9fc] text-slate-900 flex flex-col">

<!-- ê³µí†µ í—¤ë” (ë””ìì¸: ì•„ë˜ ì½”ë“œ ê¸°ì¤€) -->
<header class="bg-white border-b">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 h-14 flex items-center justify-between">
        <!-- ë¡œê³  -->
        <div class="flex items-center gap-3">
            <a href="main" class="flex items-center gap-3">
                <img src="../img/ycheck_logo.png" alt="Y-CHECK ë¡œê³ " class="h-8 w-auto">
            </a>
            <!-- ğŸ”¥ ì´ ë¶€ë¶„ ì „ì²´ ì‚­ì œë¨ -->
            <!-- <div class="hidden sm:block h-4 w-px bg-slate-200"></div>
            <div class="hidden sm:block text-xs text-slate-500">ì—°ì„¸ëŒ€í•™êµ ì¡¸ì—…ìš”ê±´ê³„ì‚°ê¸°</div> -->
        </div>

        <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
        <nav class="hidden sm:flex items-center justify-center flex-1 divide-x divide-slate-300" style="margin-left: 90px;">
            <a href="calculator" class="px-6 py-2 text-sm text-slate-600 hover:text-slate-900 font-bold">ê³„ì‚°ê¸°</a>
            <a href="timetable" class="px-6 py-2 text-sm text-slate-600 hover:text-slate-900 font-bold">ì‹œê°„í‘œ</a>
            <a href="sunbae" class="px-6 py-2 text-sm text-blue-700 hover:text-blue-800 font-bold">ì„ ë°°ë“¤ì˜ ë°œìì·¨</a>
        </nav>

        <!-- ë§ˆì´í˜ì´ì§€ -->
        <div class="hidden sm:block">
            <a href="mypage" class="px-6 py-2 text-sm text-slate-600 hover:text-slate-900 font-bold">ë§ˆì´í˜ì´ì§€</a>
        </div>
    </div>
</header>


<main class="max-w-7xl mx-auto px-4 sm:px-6 py-8 flex-1">
    <!-- ì™¼ìª½(í•„í„°) / ì˜¤ë¥¸ìª½(ì´ìˆ˜ ê¸°ë¡) ë ˆì´ì•„ì›ƒ: ë””ìì¸ì€ ì•„ë˜ ì½”ë“œ ê¸°ì¤€ -->
    <section class="grid grid-cols-1 lg:grid-cols-[0.9fr_2.1fr] gap-6">
        <!-- ì™¼ìª½ ë°•ìŠ¤: ì„ ë°° ì„ íƒ / í•„í„° (ë°±ì—”ë“œ í•„í„°ì™€ ì—°ê²°) -->
        <div class="bg-white rounded-2xl border shadow-sm p-6 min-h-[620px] flex flex-col">
            <h2 class="text-xl font-semibold mb-4">ì„ ë°° ì„ íƒ/í•„í„°</h2>

            <!-- ê´€ì‹¬ íŠ¸ë™ ì„ íƒ -->
            <div class="mb-5">
                <div class="text-sm text-slate-600 mb-2">ê´€ì‹¬ íŠ¸ë™ ì„ íƒ</div>
                <div class="flex flex-col gap-2 text-sm">
                    <label class="inline-flex items-center gap-2">
                        <!-- ë°±ì—”ë“œ: track=AI -->
                        <input type="radio" name="track" value="AI" class="h-4 w-4" id="track-ai-radio">
                        <span>AI/ë¨¸ì‹ ëŸ¬ë‹</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <!-- ë°±ì—”ë“œ: track=SECURITY -->
                        <input type="radio" name="track" value="SECURITY" class="h-4 w-4" id="track-sec-radio">
                        <span>ë³´ì•ˆ/ë„¤íŠ¸ì›Œí¬</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <!-- ë°±ì—”ë“œ: track=GAME -->
                        <input type="radio" name="track" value="GAME" class="h-4 w-4" id="track-game-radio">
                        <span>ê²Œì„/ë¯¸ë””ì–´</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <!-- ë°±ì—”ë“œ: track=EMBEDDED -->
                        <input type="radio" name="track" value="EMBEDDED" class="h-4 w-4" id="track-embedded-radio">
                        <span>ì„ë² ë””ë“œ/ì‹œìŠ¤í…œ</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <!-- ë°±ì—”ë“œ: track=STARTUP -->
                        <input type="radio" name="track" value="STARTUP" class="h-4 w-4" id="track-startup-radio">
                        <span>ì°½ì—…/ì„œë¹„ìŠ¤ ê¸°íš</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                        <!-- ë°±ì—”ë“œ: track=OTHER -->
                        <input type="radio" name="track" value="OTHER" id="track-other-radio" class="h-4 w-4">
                        <span>ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)</span>
                    </label>
                </div>

                <!-- ê¸°íƒ€ íŠ¸ë™ ì§ì ‘ ì…ë ¥ (ë°±ì—”ë“œ íŒŒë¼ë¯¸í„°ì—ëŠ” ì˜í–¥ X, UX ì „ìš©) -->
                <div id="track-other-wrap" class="mt-3 hidden">
                    <label class="block text-xs text-slate-500 mb-1">ê¸°íƒ€ ê´€ì‹¬ íŠ¸ë™</label>
                    <input
                            type="text"
                            id="track-other-input"
                            class="w-full rounded-xl border px-3 py-2 text-sm"
                            placeholder="ì˜ˆ: HCI, ë¸”ë¡ì²´ì¸ ë“±"
                    >
                </div>
            </div>

            <!-- ì„ ë°° í•™ë…„ + ì „í•„/ì „ì„  í•„í„° (í•™ë…„ì€ ë°±ì—”ë“œ grade í•„í„°ì™€ ì—°ê²°) -->
            <div class="space-y-4 flex-1">
                <div>
                    <div class="text-sm text-slate-600 mb-1">ì„ ë°° í•™ë…„</div>
                    <select id="gradeSelect" class="w-full rounded-xl border px-3 py-2 text-sm">
                        <option value="">ì „ì²´</option>
                        <option value="2">2í•™ë…„</option>
                        <option value="3">3í•™ë…„</option>
                        <option value="4">4í•™ë…„</option>
                    </select>
                </div>

                <div>
                    <div class="text-sm text-slate-600 mb-1">ì „ê³µ ê³¼ëª© ìœ í˜• í•„í„° (UIë§Œ, ì•„ì§ ë°±ì—”ë“œ ë¯¸ì—°ë™)</div>
                    <div class="flex flex-wrap items-center gap-4 text-sm">
                        <label class="inline-flex items-center gap-2">
                            <input type="radio" name="major-filter" value="major-required" class="h-4 w-4">
                            <span>ì „ê³µí•„ìˆ˜ë§Œ ë³´ê¸°</span>
                        </label>
                        <label class="inline-flex items-center gap-2">
                            <input type="radio" name="major-filter" value="major-elective" class="h-4 w-4">
                            <span>ì „ê³µì„ íƒë§Œ ë³´ê¸°</span>
                        </label>
                    </div>
                </div>

                <!-- ì ìš©í•˜ê¸° ë²„íŠ¼ -->
                <div class="pt-2">
                    <button
                            type="button"
                            id="apply-filter-btn"
                            class="w-full rounded-xl bg-blue-600 text-white py-2 text-sm font-semibold">
                        ì ìš©í•˜ê¸°
                    </button>
                </div>
            </div>
        </div>

        <!-- ì˜¤ë¥¸ìª½ ë°•ìŠ¤: ì„ ë°°ì˜ ì‹¤ì œ ì´ìˆ˜ ê¸°ë¡ (ë””ìì¸+ë°±ì—”ë“œ ë°ì´í„° ê²°í•©) -->
        <div class="bg-white rounded-2xl border shadow-sm p-6 min-h-[620px] flex flex-col">
            <div class="flex items-center justify-between mb-2">
                <h3 class="text-lg font-semibold">ì„ ë°°ì˜ ì‹¤ì œ ì´ìˆ˜ ê¸°ë¡</h3>
                <p id="sunbaeSummaryText" class="text-xs text-slate-500">
                    ê³µìœ ëœ ì‹œê°„í‘œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 flex-1">
                <!-- ì„ ë°° ëª©ë¡ (ë°±ì—”ë“œì—ì„œ ë°›ì•„ì˜¨ ì‹œê°„í‘œ ë¦¬ìŠ¤íŠ¸) -->
                <div class="lg:col-span-1 flex flex-col">
                    <div class="text-sm text-slate-600 mb-2">ì„ ë°° ëª©ë¡</div>
                    <div class="space-y-3 max-h-[420px] overflow-y-auto pr-1" id="senior-list">
                        <!-- JSì—ì„œ ë²„íŠ¼ ìƒì„± -->
                    </div>
                    <div id="sunbae-empty-state" class="text-xs text-slate-500 mt-4 hidden">
                        ì¡°ê±´ì— ë§ëŠ” ì„ ë°° ì‹œê°„í‘œê°€ ì—†ìŠµë‹ˆë‹¤.
                    </div>
                </div>

                <!-- ìƒì„¸ ì´ìˆ˜ ê¸°ë¡ ì˜ì—­ -->
                <div class="lg:col-span-2 bg-slate-50 rounded-xl p-4 flex flex-col h-full" id="senior-detail">
                    <div class="flex items-center justify-between gap-3">
                        <div>
                            <div id="detail-name" class="text-base font-semibold">ê³µìœ ëœ ì‹œê°„í‘œ</div>
                            <div id="detail-meta" class="text-xs text-slate-600 mt-0.5">
                                ì„ ë°°ì˜ ì‹¤ì œ ì´ìˆ˜ ê¸°ë¡ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.
                            </div>
                        </div>
                        <button
                                id="toggle-detail"
                                class="px-3 py-1.5 rounded-full bg-blue-600 text-white text-xs font-semibold"
                        >
                            ìì„¸í•œ ì´ìˆ˜ ê¸°ë¡ ë³´ê¸°
                        </button>
                    </div>

                    <!-- ìš”ì•½ í…ìŠ¤íŠ¸ -->
                    <div id="detail-summary" class="text-xs text-slate-600 mt-2">
                        ì¡°ê±´ì— ë§ëŠ” ì‹œê°„í‘œë¥¼ ì„ íƒí•˜ë©´ ê³¼ëª© ëª©ë¡ì´ í‘œì‹œë©ë‹ˆë‹¤.
                    </div>

                    <!-- ì´ìˆ˜ ê³¼ëª© ë¦¬ìŠ¤íŠ¸: ìƒì ì•ˆì—ì„œ ìŠ¤í¬ë¡¤ -->
                    <div id="records-scroll" class="mt-3 flex-1 overflow-y-auto space-y-4 pr-2">
                        <!-- í•­ìƒ ë³´ì´ëŠ” ìš”ì•½ ì˜ì—­ -->
                        <div>
                            <div class="text-sm font-semibold mb-2 text-slate-700">ì´ìˆ˜ ê³¼ëª©</div>
                            <div id="summary-body" class="space-y-3 text-sm">
                                <!-- ì„ íƒëœ ì‹œê°„í‘œì˜ ê³¼ëª©ì„ JSë¡œ ë Œë”ë§ -->
                            </div>
                        </div>

                        <!-- í† ê¸€ë¡œ ì—¬ë‹«ëŠ” ì¶”ê°€ ì˜ì—­ (í˜„ì¬ëŠ” í™•ì¥ìš© / í•„ìš”ì‹œ ì‚¬ìš©) -->
                        <div>
                            <div id="detail-body" class="space-y-3 text-sm hidden"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<!-- í‘¸í„°: í™”ë©´ ì•„ë˜ì— ê³ ì •ë˜ì§€ ì•Šê³ , ë‚´ìš© ëì— ìœ„ì¹˜ (ë””ìì¸: ì•„ë˜ ì½”ë“œ ê¸°ì¤€) -->
<footer class="bg-white border-t w-full">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 py-4 flex items-start justify-between">
        <div class="flex items-start gap-4">
            <div class="space-y-0.5 text-sm text-slate-600 leading-tight">
                <div>Inc: ê°•ì›íŠ¹ë³„ìì¹˜ë„ ì›ì£¼ì‹œ í¥ì—…ë©´ ì—°ì„¸ëŒ€ê¸¸ 1</div>
                <div>Instagram: @Y_CHECK.YONSEI</div>
                <div>Email: YCHECK2025@gmail.com</div>
            </div>
        </div>
        <div class="flex items-center gap-6 text-sm text-slate-600 leading-tight" style="margin-top: 12px;">
            <span class="hidden sm:block h-6 w-px bg-slate-200"></span>
            <a href="#" class="text-xs text-black-600 hover:underline" id="open-makers-modal"><span>ë§Œë“ ì´ë“¤</span></a>
            <a href="#" class="text-xs text-black-600 hover:underline" id="open-contact-modal"><span>ë¬¸ì˜í•˜ê¸°</span></a>
        </div>
    </div>
</footer>

<!-- ë§Œë“ ì´ë“¤ ëª¨ë‹¬ -->
<div id="makers-modal-overlay"
     class="fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center z-50 hidden">
    <div class="bg-white rounded-2xl px-6 py-8 w-full max-w-md shadow-xl relative">
        <button id="close-makers-modal"
                class="absolute top-3 right-3 text-slate-500 hover:text-slate-700 text-2xl font-bold"
                aria-label="ë‹«ê¸°">
            &times;
        </button>
        <h2 class="text-xl font-bold mb-4 text-center">ë§Œë“ ì´ë“¤</h2>
        <div class="space-y-2 text-sm text-slate-700">
            <div><strong>PM</strong> â€“ CHOI</div>
            <div><strong>Back-end</strong> â€“ KIM / MA</div>
            <div><strong>Front-end</strong> â€“ YU / LEE</div>
            <hr class="my-2">
            <div class="text-xs text-slate-500">
                Y_CHECK ì„œë¹„ìŠ¤ëŠ” ìœ„ íŒ€ì›ì´ í•¨ê»˜ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.<br>
                ê¶ê¸ˆí•œ ì ì€ ì–¸ì œë“  ë¬¸ì˜í•´ ì£¼ì„¸ìš”!
            </div>
        </div>
    </div>
</div>



<!-- ë¬¸ì˜í•˜ê¸° ëª¨ë‹¬ -->
<div id="contact-modal-overlay"
     class="fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center z-50 hidden">
    <div class="bg-white rounded-2xl px-6 py-8 w-full max-w-md shadow-xl relative">
        <button id="close-contact-modal"
                class="absolute top-3 right-3 text-slate-500 hover:text-slate-700 text-2xl font-bold"
                aria-label="ë‹«ê¸°">&times;</button>
        <h2 class="text-xl font-bold mb-5 text-center">ë¬¸ì˜í•˜ê¸°</h2>
        <form class="space-y-4" id="contact-form" autocomplete="off">
            <div>
                <label for="inquiry-type" class="block text-sm mb-1 font-medium text-slate-700">ë¬¸ì˜ ìœ í˜•</label>
                <select id="inquiry-type" name="inquiry-type" class="w-full rounded-xl border px-3 py-2 text-sm">
                    <option value="" selected disabled>ë¬¸ì˜ ìœ í˜•ì„ ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="ê³„ì •">ê³„ì • ê´€ë ¨</option>
                    <option value="ë¶ˆí¸">ì´ìš© ë¶ˆí¸</option>
                    <option value="ê±´ì˜">ê¸°ëŠ¥ ê±´ì˜</option>
                    <option value="ì˜¤ë¥˜">ë²„ê·¸/ì˜¤ë¥˜ ì‹ ê³ </option>
                    <option value="ê¸°íƒ€">ê¸°íƒ€(ì§ì ‘ì…ë ¥)</option>
                </select>
            </div>
            <div id="custom-type-wrap" class="hidden">
                <input type="text" id="custom-type"
                       class="w-full rounded-xl border px-3 py-2 text-sm mt-2"
                       placeholder="ë¬¸ì˜ ì¢…ë¥˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
            </div>
            <div>
                <label for="inquiry-content" class="block text-sm mb-1 font-medium text-slate-700">ë¬¸ì˜ ë‚´ìš©</label>
                <textarea id="inquiry-content" name="inquiry-content"
                          rows="4"
                          class="w-full rounded-xl border px-3 py-2 text-sm resize-none"
                          placeholder="ë¬¸ì˜í•˜ì‹¤ ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”."
                          required></textarea>
            </div>
            <button type="submit"
                    class="w-full rounded-xl bg-blue-700 text-white py-2 text-sm font-semibold mt-2">
                ë¬¸ì˜ ì ‘ìˆ˜í•˜ê¸°
            </button>
        </form>
        <div id="contact-success" class="hidden mt-4 text-green-600 text-sm text-center font-semibold">
            ë¬¸ì˜ê°€ ì •ìƒì ìœ¼ë¡œ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.
        </div>
    </div>
</div>

<script>
    /* ====== ê³µí†µ ëª¨ë‹¬ ìŠ¤í¬ë¦½íŠ¸ (ë””ìì¸ ì½”ë“œ ê·¸ëŒ€ë¡œ) ====== */
    const openMakersBtn = document.getElementById('open-makers-modal');
    const makersModal = document.getElementById('makers-modal-overlay');
    const closeMakersBtn = document.getElementById('close-makers-modal');
    if (openMakersBtn && makersModal && closeMakersBtn) {
      openMakersBtn.addEventListener('click', function(e) {
        e.preventDefault();
        makersModal.classList.remove('hidden');
      });
      closeMakersBtn.addEventListener('click', function() {
        makersModal.classList.add('hidden');
      });
      makersModal.addEventListener('click', function(e) {
        if (e.target === makersModal) {
          makersModal.classList.add('hidden');
        }
      });
      document.addEventListener('keydown', function(e) {
        if (!makersModal.classList.contains('hidden') && e.key === 'Escape') {
          makersModal.classList.add('hidden');
        }
      });
    }

    const openContactBtn = document.getElementById('open-contact-modal');
    const contactModal = document.getElementById('contact-modal-overlay');
    const closeContactBtn = document.getElementById('close-contact-modal');
    if (openContactBtn && contactModal && closeContactBtn) {
      openContactBtn.addEventListener('click', function(e) {
        e.preventDefault();
        contactModal.classList.remove('hidden');
      });
      closeContactBtn.addEventListener('click', function() {
        contactModal.classList.add('hidden');
      });
      contactModal.addEventListener('click', function(e) {
        if (e.target === contactModal) {
          contactModal.classList.add('hidden');
        }
      });

      const inquiryType = document.getElementById('inquiry-type');
      const customTypeWrap = document.getElementById('custom-type-wrap');
      const customTypeInput = document.getElementById('custom-type');
      if (inquiryType && customTypeWrap && customTypeInput) {
        inquiryType.addEventListener('change', function () {
          if (this.value === 'ê¸°íƒ€') {
            customTypeWrap.classList.remove('hidden');
            customTypeInput.setAttribute('required', 'required');
          } else {
            customTypeWrap.classList.add('hidden');
            customTypeInput.value = '';
            customTypeInput.removeAttribute('required');
          }
        });
      }

      const contactForm = document.getElementById('contact-form');
      const contactSuccess = document.getElementById('contact-success');
      if (contactForm && contactSuccess) {
        contactForm.addEventListener('submit', function(e) {
          e.preventDefault();
          contactForm.classList.add('hidden');
          contactSuccess.classList.remove('hidden');
          setTimeout(() => {
            contactModal.classList.add('hidden');
            contactForm.reset();
            contactForm.classList.remove('hidden');
            customTypeWrap.classList.add('hidden');
            contactSuccess.classList.add('hidden');
          }, 1800);
        });
      }
    }

    /* ====== ê´€ì‹¬ íŠ¸ë™ ê¸°íƒ€ ì…ë ¥ (ë””ìì¸ ì½”ë“œ ê·¸ëŒ€ë¡œ, + í•„í„° ì—°ë™) ====== */
    const trackRadios = document.querySelectorAll('input[name="track"]');
    const trackOtherWrap = document.getElementById('track-other-wrap');
    const trackOtherInput = document.getElementById('track-other-input');

    /* ====== ë°±ì—”ë“œ ì—°ë™ìš© ê³µí†µ ìƒíƒœ/ìš”ì†Œ ====== */
    const summaryText = document.getElementById("sunbaeSummaryText");
    const emptyState = document.getElementById("sunbae-empty-state");
    const seniorList = document.getElementById("senior-list");

    const detailName = document.getElementById("detail-name");
    const detailMeta = document.getElementById("detail-meta");
    const detailSummary = document.getElementById("detail-summary");
    const summaryBody = document.getElementById("summary-body");
    const detailBody = document.getElementById("detail-body");
    const toggleDetailBtn = document.getElementById("toggle-detail");

    const gradeSelectEl = document.getElementById("gradeSelect");
    const applyFilterBtn = document.getElementById("apply-filter-btn");

    let allRecords = [];   // ë°±ì—”ë“œì—ì„œ ë°›ì•„ì˜¨ ì „ì²´ ì‹œê°„í‘œ ë¦¬ìŠ¤íŠ¸
    let currentTrack = ""; // ""ë©´ ì „ì²´
    let currentGrade = ""; // ""ë©´ ì „ì²´
    let selectedIndex = -1;

    // ê³¼ëª© ìœ í˜• ë±ƒì§€ ìƒ‰ìƒ (ì „í•„/ì „ì„ /ê¸°íƒ€)
    function getCategoryBadge(category) {
      if (category === "ì „í•„") return "bg-rose-100 text-rose-700";
      if (category === "ì „ì„ ") return "bg-emerald-100 text-emerald-700";
      return "bg-slate-100 text-slate-600";
    }

    // ì„ ë°° ëª©ë¡ ë Œë”ë§
    function renderSeniorList() {
      seniorList.innerHTML = "";
      emptyState.classList.add("hidden");

      if (!allRecords.length) {
        emptyState.classList.remove("hidden");
        detailName.textContent = "ê³µìœ ëœ ì‹œê°„í‘œ";
        detailMeta.textContent = "ì¡°ê±´ì— ë§ëŠ” ì„ ë°° ì‹œê°„í‘œê°€ ì—†ìŠµë‹ˆë‹¤.";
        detailSummary.textContent = "";
        summaryBody.innerHTML = "";
        selectedIndex = -1;
        return;
      }

      allRecords.forEach((entry, idx) => {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className =
          "w-full text-left border rounded-xl px-3 py-2 text-sm hover:border-blue-500 hover:bg-blue-50";
        btn.dataset.index = idx.toString();
        btn.innerHTML = `
          <div class="font-semibold text-slate-800">${entry.label || "ê³µìœ  ì‹œê°„í‘œ"}</div>
          <div class="text-xs text-slate-500">
            ${(entry.user && (entry.user.display_name || entry.user.username)) || "ì„ ë°°"}
          </div>
        `;
        btn.addEventListener("click", () => {
          setActiveSenior(idx);
          renderSelectedRecord(idx);
        });
        seniorList.appendChild(btn);
      });

      // ì²« ë²ˆì§¸ í•­ëª© ìë™ ì„ íƒ
      setActiveSenior(0);
      renderSelectedRecord(0);
    }

    // ì„ íƒëœ ì„ ë°° ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì²˜ë¦¬
    function setActiveSenior(index) {
      selectedIndex = index;
      const buttons = seniorList.querySelectorAll("button[data-index]");
      buttons.forEach((b, i) => {
        b.classList.remove(
          "border-blue-500",
          "ring-2",
          "ring-blue-400",
          "bg-blue-50"
        );
        if (i === index) {
          b.classList.add(
            "border-blue-500",
            "ring-2",
            "ring-blue-400",
            "bg-blue-50"
          );
        }
      });

      // ìƒì„¸ ì˜ì—­ ì ‘ê¸° ì´ˆê¸°í™”
      if (detailBody) {
        detailBody.classList.add("hidden");
      }
      if (toggleDetailBtn) {
        toggleDetailBtn.textContent = "ìì„¸í•œ ì´ìˆ˜ ê¸°ë¡ ë³´ê¸°";
      }
    }

    // ì„ íƒëœ ì‹œê°„í‘œ ìƒì„¸ ë Œë”ë§
    function renderSelectedRecord(index) {
      const entry = allRecords[index];
      if (!entry) return;

      const userName =
        (entry.user && (entry.user.display_name || entry.user.username)) ||
        "ì„ ë°°";

      detailName.textContent = entry.label || "ê³µìœ ëœ ì‹œê°„í‘œ";
      detailMeta.textContent = `${userName}ì˜ ê³µìœ  ì‹œê°„í‘œ`;

      const courses = Array.isArray(entry.courses) ? entry.courses : [];
      if (!courses.length) {
        detailSummary.textContent = "ë“±ë¡ëœ ê³¼ëª©ì´ ì—†ìŠµë‹ˆë‹¤.";
        summaryBody.innerHTML = `<p class="text-xs text-slate-400">ë“±ë¡ëœ ê³¼ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p>`;
        return;
      }

      detailSummary.textContent = `ì´ ${courses.length}ê°œ ê³¼ëª©ì´ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤.`;

      summaryBody.innerHTML = "";
      const card = document.createElement("article");
      card.className = "border rounded-2xl p-4 bg-white shadow-sm text-sm";
      card.innerHTML = `
        <ul class="space-y-1">
          ${courses
            .map(
              (c) => `
            <li class="flex items-center justify-between">
              <span>${c.subject || "-"}</span>
              ${
                c.memo
                  ? `<span class="px-2 py-0.5 rounded-full ${getCategoryBadge(
                      c.memo
                    )} text-xs">${c.memo}</span>`
                  : ""
              }
            </li>
          `
            )
            .join("")}
        </ul>
      `;
      summaryBody.appendChild(card);
    }

    // ê³µìœ ëœ ì‹œê°„í‘œ ë¶ˆëŸ¬ì˜¤ê¸° (ë°±ì—”ë“œ í˜¸ì¶œ)
    async function loadSharedTimetables() {
      if (summaryText) {
        summaryText.textContent = "ê³µìœ ëœ ì‹œê°„í‘œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...";
      }
      allRecords = [];
      seniorList.innerHTML = "";
      emptyState.classList.add("hidden");
      summaryBody.innerHTML = "";
      detailName.textContent = "ê³µìœ ëœ ì‹œê°„í‘œ";
      detailMeta.textContent = "ì„ ë°°ì˜ ì‹¤ì œ ì´ìˆ˜ ê¸°ë¡ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.";
      detailSummary.textContent = "ì¡°ê±´ì— ë§ëŠ” ì‹œê°„í‘œë¥¼ ì„ íƒí•˜ë©´ ê³¼ëª© ëª©ë¡ì´ í‘œì‹œë©ë‹ˆë‹¤.";

      const params = new URLSearchParams();
      if (currentTrack) params.append("track", currentTrack);
      if (currentGrade) params.append("grade", currentGrade);

      const query = params.toString();
      const url = query
        ? `/api/footprints/timetables/?${query}`
        : `/api/footprints/timetables/`;

      try {
        const res = await fetch(url, {
          method: "GET",
          credentials: "include",
        });

        if (!res.ok) {
          if (summaryText) {
            summaryText.textContent = "ì‹œê°„í‘œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
          }
          emptyState.classList.remove("hidden");
          return;
        }

        const data = await res.json();
        const results = Array.isArray(data.results) ? data.results : [];

        allRecords = results;

        if (!allRecords.length) {
          if (summaryText) {
            summaryText.textContent = "ì¡°ê±´ì— ë§ëŠ” ì„ ë°° ì‹œê°„í‘œê°€ ì—†ìŠµë‹ˆë‹¤.";
          }
          emptyState.classList.remove("hidden");
          return;
        }

        renderSeniorList();

        if (summaryText) {
          summaryText.textContent = `ì¡°ê±´ì— ë§ëŠ” ì„ ë°° ì‹œê°„í‘œ ${allRecords.length}ê°œê°€ ìˆìŠµë‹ˆë‹¤.`;
        }
      } catch (err) {
        console.error(err);
        if (summaryText) {
          summaryText.textContent = "ì‹œê°„í‘œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
        }
        emptyState.classList.remove("hidden");
      }
    }

    // íŠ¸ë™ ë¼ë””ì˜¤ + ê¸°íƒ€ ì…ë ¥ + ë°±ì—”ë“œ í•„í„° ì—°ë™
    if (trackRadios && trackOtherWrap && trackOtherInput) {
      trackRadios.forEach(radio => {
        radio.addEventListener('change', () => {
          if (radio.value === 'OTHER' && radio.checked) {
            trackOtherWrap.classList.remove('hidden');
          } else if (radio.checked) {
            trackOtherWrap.classList.add('hidden');
            trackOtherInput.value = '';
          }

          if (radio.checked) {
            currentTrack = radio.value;
            loadSharedTimetables();
          }
        });
      });
    }

    // í•™ë…„ ì„ íƒ ì‹œ ë°±ì—”ë“œ í•„í„° ì—°ë™
    if (gradeSelectEl) {
      gradeSelectEl.addEventListener("change", (e) => {
        currentGrade = e.target.value;
        loadSharedTimetables();
      });
    }

    // ì ìš©í•˜ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ (ì•ˆì „í•˜ê²Œ í•œ ë²ˆ ë” ë¡œë“œ)
    if (applyFilterBtn) {
      applyFilterBtn.addEventListener("click", () => {
        const checked = document.querySelector('input[name="track"]:checked');
        if (checked) currentTrack = checked.value;
        currentGrade = gradeSelectEl ? gradeSelectEl.value : "";
        loadSharedTimetables();
      });
    }

    // ìƒì„¸ í† ê¸€ ë²„íŠ¼ (í˜„ì¬ëŠ” í™•ì¥ ì˜ì—­ì´ ë¹„ì–´ìˆì§€ë§Œ UI ìœ ì§€)
    if (toggleDetailBtn && detailBody) {
      toggleDetailBtn.addEventListener("click", () => {
        const isHidden = detailBody.classList.contains("hidden");
        if (isHidden) {
          detailBody.classList.remove("hidden");
          toggleDetailBtn.textContent = "ìì„¸í•œ ì´ìˆ˜ ê¸°ë¡ ìˆ¨ê¸°ê¸°";
        } else {
          detailBody.classList.add("hidden");
          toggleDetailBtn.textContent = "ìì„¸í•œ ì´ìˆ˜ ê¸°ë¡ ë³´ê¸°";
        }
      });
    }

    // ì´ˆê¸° ìƒíƒœ ì„¤ì •: ê¸°ë³¸ íŠ¸ë™ ì„ íƒ + ì‹œê°„í‘œ ë¡œë“œ
    (function initFiltersAndLoad() {
      // ê¸°ë³¸ íŠ¸ë™: ì•„ë¬´ ê²ƒë„ ì„ íƒ ì•ˆ ë˜ì–´ ìˆìœ¼ë©´ AIë¡œ
      let defaultTrackRadio = document.querySelector('input[name="track"]:checked');
      if (!defaultTrackRadio) {
        const aiRadio = document.getElementById("track-ai-radio");
        if (aiRadio) {
          aiRadio.checked = true;
          defaultTrackRadio = aiRadio;
        }
      }
      currentTrack = defaultTrackRadio ? defaultTrackRadio.value : "";

      currentGrade = gradeSelectEl ? gradeSelectEl.value : "";

      loadSharedTimetables();
    })();
</script>
</body>
</html>
